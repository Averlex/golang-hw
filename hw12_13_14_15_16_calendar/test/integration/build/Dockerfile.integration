# Launching integration tests.
FROM golang:1.24-alpine AS build

ENV CODE_DIR /go/src/

WORKDIR ${CODE_DIR}

# Caching the modules layers.
COPY go.mod .
COPY go.sum .
RUN go mod download

ENV TEST_FILE ${CODE_DIR}/integration/integration_test.go
COPY ./test/integration/integration_test.go ${TEST_FILE}

CMD CGO_ENABLED=0 go test \
    -v -count=1 \
    -timeout=1m -tags=integration \
    ${TEST_FILE}
